<script type='text/javascript'>
  var swfu;

  window.onload = function () {
    swfu = new SWFUpload({
      upload_url : '<%= new_post_path_for_swf_upload %>',
      flash_url : '/flash/swfupload.swf',

			button_image_url: "/images/upload.png",
			button_width: "64",
			button_height: "27",
			button_placeholder_id: "SwfUploadButton",

      file_size_limit : '100000',
      file_types : '*.mp3',
      file_types_description : 'Files',
      file_upload_limit : '0',
			custom_settings : {
				progressTarget : "fsUploadProgress"
			},

      file_queue_error_handler : uploadError,
      file_dialog_complete_handler : fileDialogComplete,
      upload_progress_handler : uploadProgress,
      upload_error_handler : uploadError,
      upload_success_handler : uploadSuccess,
      upload_complete_handler : uploadComplete,

			post_params : {
				authenticity_token : '<%= u form_authenticity_token -%>',
			},

      custom_settings : { 
        upload_target : 'SwfUploadProgress',
      },

      debug: false

    });
  };
</script>

<div id="SwfUploadButton"> </div>
<div id="SwfUploadProgress"> </div>

<ul class="playlist">
  <% @posts.each do |post| %>
    <%= render post %>
  <% end if @posts %>
</ul>

<div id="control-template">
 <!-- control markup inserted dynamically after each link -->
 <div class="controls">
  <div class="statusbar">
   <div class="loading"></div>
    <div class="position"></div>
  </div>
 </div>
 <div class="timing">
  <div id="sm2_timing" class="timing-data">
   <span class="sm2_position">%s1</span> / <span class="sm2_total">%s2</span></div>
 </div>
 <div class="peak">
  <div class="peak-box"><span class="l"></span><span class="r"></span>
  </div>
 </div>
</div>

<div id="spectrum-container" class="spectrum-container">
 <div class="spectrum-box">
  <div class="spectrum"></div>
 </div>
</div> 

<ul class="users">
  <% @users.each do |user| %>
    <li><b><%= link_to h(user), user %></b></li>
  <% end if @users %>
</ul>
